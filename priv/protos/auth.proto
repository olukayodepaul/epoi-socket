syntax = "proto3";

package auth;

service AuthService {
  rpc DeviceAuth (AuthRequest) returns (AuthReply) {} 
  rpc GenerateDeviceToken (GenerateTokenReq) returns (GenerateTokenRes) {}
  rpc BlackListToken (BlackListTokenReq) returns (BlackListTokenRes) {}
  rpc GenAccessFromRefreshToken (GenerateAccessTokenFromRefreshTokenReq) returns (GenerateAccessTokenFromRefreshTokenRes) {}
}

message AuthReply {
  int32 status = 1;
  int32 type = 2; 
  string jti = 3;
  string message = 4;
  string device_id = 5;
  string jid = 6;
}

message AuthRequest {
  string token = 1;
  int32 type = 2;
}

message GenerateTokenReq{
  string jid = 1;
  string device_id = 2;
  int32 user_id = 3; 
}

message GenerateTokenRes{
  string status = 1;
  string refresh_token = 2;
  string access_token =3;
  string message = 4;
}

message BlackListTokenReq{
  string token = 1;
}

message BlackListTokenRes{
  string status = 1;
  string message = 4;
}

message GenerateAccessTokenFromRefreshTokenReq{
  string token = 1 ;
}

message GenerateAccessTokenFromRefreshTokenRes{
  string status = 1;
  string refresh_token = 2;
  string access_token =3;
  string message = 4;
}

