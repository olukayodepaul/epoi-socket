syntax = "proto3";

package dartmessaging;

// Awareness Protocol: user/device presence query and notifications

// Request to query the awareness of another entity
message AwarenessRequest {
  string from = 1;       // Requesting entity (EID)
  string to = 2;         // Target entity (EID)
  int64 request_id = 3;  // Unique request identifier
}

// Response to an AwarenessRequest
message AwarenessResponse {
  string from = 1;        // Responding entity (EID)
  string to = 2;          // Original requester (EID)
  int64 request_id = 3;   // Must match AwarenessRequest.request_id

  AwarenessStatus status = 4;   // Awareness state
  int64 last_seen = 5;          // Unix UTC timestamp
  double latitude = 6;          // Optional: defaults to 0.0 if not set
  double longitude = 7;         // Optional: defaults to 0.0 if not set
  int32 awareness_intention = 8;// Optional: defaults to 0 if not set
}

// Notification for awareness changes (push to subscribers)
message AwarenessNotification {
  string from = 1;               // Entity whose awareness changed
  string to = 2;                 // Target entity (EID)
  AwarenessStatus status = 3;    // Current awareness state
  int64 last_seen = 4;           // Unix UTC timestamp
  double latitude = 5;           // Optional: defaults to 0.0 if not set
  double longitude = 6;          // Optional: defaults to 0.0 if not set
  int32 awareness_intention = 7; // Optional: defaults to 0 if not set
}

// Standardized awareness states
enum AwarenessStatus {
  STATUS_UNSPECIFIED = 0;
  ONLINE = 1;
  OFFLINE = 2;
  AWAY = 3;
  DND = 4;        // Do Not Disturb
  BUSY = 5;
  INVISIBLE = 6;
  NOT_FOUND = 7;
  UNKNOWN = 8;
}

// Generic wrapper using google.protobuf.Any
// Wrapper message with route + oneof payload
message MessageScheme {
  int64 route = 1;  // a logical route / channel
  oneof payload {
    AwarenessNotification awareness_notification = 2;
    AwarenessResponse awareness_response = 3;
  }
}
